#Zadanie 1
#Utwórz tabelę student z następującymi polami:
#id_studenta - liczba całkowita nieujemna, klucz główny, auto numeracja,
#imie - łańcuch znaków, długość max 100, wymagany
#nazwisko - łańcuch znaków, długość max 100, wymagany
#rok_studiow - wartość numeryczna nieujemna,
#data_urodzenia - typ daty.

CREATE table student (
id_studenta INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
imie VARCHAR(100) NOT NULL,
nazwisko VARCHAR(100) NOT NULL,
rok_studiow INT UNSIGNED,
data_urodzenia DATE
);

#Zadanie 2
#Utwórz tabelę o nazwie kierunek z polami:
#id_kierunku - liczba całkowita nieujemna, klucz główny, auto numeracja,
#nazwa_kierunku - łańcuch znaków, max. 200 znaków, niepuste.

CREATE table kierunek (
id_kierunku INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
nazwa_kierunku VARCHAR(200) NOT NULL
);

#Zadanie 3
#Utwórz tabelę o nazwie student_na_kierunku z polami:
#student - klucz obcy do tabeli student, część klucza głównego
#kierunek - klucz obcy do tabeli kierunek, część klucza głównego

CREATE TABLE student_na_kierunku (
student INT UNSIGNED NOT NULL,
kierunek INT UNSIGNED NOT NULL,
PRIMARY KEY (student, kierunek),
FOREIGN KEY (student) REFERENCES student(id_studenta),
FOREIGN KEY (kierunek) REFERENCES kierunek(id_kierunku)
);

#Zadanie 4
#Utwórz tabelę przedmiot z polami:
#id_przedmiotu, numeryczne, klucz główny, automatyczna inkrementacja
#nazwa_przedmiotu, łańcuch znaków, max. 200 znaków, wymagane
#opis, długi tekst, opcjonalne

CREATE table przedmiot (
id_przedmiotu INT AUTO_INCREMENT PRIMARY KEY,
nazwa_przedmiotu VARCHAR(200) NOT NULL,
opis TEXT NULL
);

#Zadanie 5
#Utwórz tabelę o nazwie kierunek_has_przedmioty z polami:
#kierunek, klucz obcy do tabeli kierunek, wymagane, część klucza głównego,
#przedmiot, klucz obcy do tabeli przedmiot, wymagane, część klucz głównego,
#obowiazkowy, wartość logiczna, domyślnie 1 (prawda),

CREATE TABLE kierunek_has_przedmioty (
kierunek INT UNSIGNED NOT NULL,
przedmiot INT UNSIGNED NOT NULL,
obowiazkowy BOOLEAN DEFAULT 1,
PRIMARY KEY (kierunek, przedmiot),
FOREIGN KEY (kierunek) REFERENCES kierunek(id_kierunku),
FOREIGN KEY (przedmiot) REFERENCES przedmiot(id_przedmiotu)
);

#Zadanie 6
#Dodaj dane do tabel w następującej ilości:
#tabela student - 4 rekordy,

INSERT INTO student (imie, nazwisko, rok_studiow, data_urodzenia) VALUES
('Imie1', 'Nazwisko1', 1, '2004-01-01'),
('Imie2', 'Nazwisko2', 2, '2003-02-02'),
('Imie3', 'Nazwisko3', 2, '2002-03-03'),
('Imie4', 'Nazwisko4', 3, '2001-04-04');

#tabela kierunek - 2 rekordy,

INSERT INTO kierunek (nazwa_kierunku) VALUES
('Informatyka'),
('Matematyka');

#tabela student_na_kierunku - przypisz wszystkich studentów do jakiegoś kierunku,

INSERT INTO student_na_kierunku (student, kierunek) VALUES
(1, 1),
(2, 1),
(3, 2),
(4, 2);

#tabela przedmiot - 4 rekordy, przynajmniej jeden przedmiot nieobowiązkowy,

INSERT INTO przedmiot (nazwa_przedmiotu, opis) VALUES
('Bazy danych', 'Zarządzanie zbiorami informacji'),
('Programowanie', 'Programowanie w Pythonie'),
('Matematyka współczesna', 'Zbiory, logika'),
('Etyka', 'Przedmiot humanistyczny');

#tabela kierunek_has_przedmioty - przypisz wszystkie przedmioty do dowolnych kierunków,

INSERT INTO kierunek_has_przedmioty (kierunek, przedmiot, obowiazkowy) VALUES
(1, 1, 1),
(1, 2, 1),
(1, 3, 1),
(2, 4, 0);

#Zadanie 7
#Zmień typ kolumny opis w tabeli przedmiot na VARCHAR oraz ustaw wartość domyślną dla tej kolumny na Brak opisu.

ALTER table przedmiot	
MODIFY opis VARCHAR(100) NOT NULL DEFAULT 'Brak opisu';

#Zadanie 8
#W tabeli student dodaj nową kolumnę o nazwie indeks i ustaw ją jako klucz główny. 

ALTER TABLE student
ADD COLUMN indeks INT UNSIGNED NOT NULL;

#Zadanie 9
#Do tabeli kierunek_has_przedmioty dodaj nowe kolumny:
#semestr, typ tekstowy, pole wymagane i wstaw dane w formacie np. 2024Z, 2024L, itp.,
#rok_studiow - numeryczne, nieujemne, wymagane, uzupełnij danymi

ALTER table kierunek_has_przedmioty
ADD COLUMN semestr VARCHAR(10) NOT NULL,
ADD COLUMN rok_studiow INT UNSIGNED NOT NULL;

UPDATE kierunek_has_przedmioty
SET semestr = '2024Z', rok_studiow = 1
WHERE kierunek = 1;

UPDATE kierunek_has_przedmioty
SET semestr = '2024L', rok_studiow = 2
WHERE kierunek = 2;

#Zadanie 10
#Napisz zapytanie wybierające, które wyświetli indeks studenta, jego imię i nazwisko, 
#nazwę kierunku studiów, semestr oraz nazwę przedmiotu.

SELECT
s.indeks,
s.imie,
s.nazwisko,
k.nazwa_kierunku,
khp.semestr,
p.nazwa_przedmiotu
FROM student s
JOIN student_na_kierunku snk
ON snk.student = s.id_studenta
JOIN kierunek k
ON k.id_kierunku = snk.kierunek
JOIN kierunek_has_przedmioty khp
ON khp.kierunek = k.id_kierunku
JOIN przedmiot p
ON p.id_przedmiotu = khp.przedmiot
ORDER BY s.indeks, k.nazwa_kierunku, khp.semestr, p.nazwa_przedmiotu;
